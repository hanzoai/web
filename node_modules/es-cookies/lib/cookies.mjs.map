{"version":3,"file":"cookies.mjs","sources":["../src/cookies.coffee","../src/index.coffee"],"sourcesContent":["import isNumber     from 'es-is/number'\nimport objectAssign from 'es-object-assign'\n\n\nclass Cookies\n  constructor: (@defaults = {}) ->\n    @get     = (key) => @read key\n    @getJSON = (key) =>\n      try\n        JSON.parse @read key\n      catch err\n        {}\n\n    @remove = (key, attrs)        => @write key, '', objectAssign expires: -1, attrs\n    @set    = (key, value, attrs) => @write key, value, attrs\n\n  read: (key) ->\n    unless key\n      result = {}\n\n    # To prevent the for loop in the first place assign an empty array in case\n    # there are no cookies at all. Also prevents odd result when calling\n    # \"get()\"\n    cookies = if document.cookie then document.cookie.split('; ') else []\n    rdecode = /(%[0-9A-Z]{2})+/g\n\n    for kv in cookies\n      parts  = kv.split '='\n      cookie = parts.slice(1).join '='\n\n      if cookie.charAt(0) == '\"'\n        cookie = cookie.slice 1, -1\n\n      try\n        name   = parts[0].replace rdecode, decodeURIComponent\n        cookie = cookie.replace   rdecode, decodeURIComponent\n\n        if key == name\n          return cookie\n        unless key\n          result[name] = cookie\n\n      catch err\n\n    result\n\n  write: (key, value, attrs) ->\n    attrs = objectAssign path: '/', @defaults, attrs\n\n    if isNumber attrs.expires\n      expires = new Date\n      expires.setMilliseconds expires.getMilliseconds() + attrs.expires * 864e+5\n      attrs.expires = expires\n\n    # We're using \"expires\" because \"max-age\" is not supported by IE\n    attrs.expires = if attrs.expires then attrs.expires.toUTCString() else ''\n\n    try\n      result = JSON.stringify(value)\n      if /^[\\{\\[]/.test(result)\n        value = result\n    catch err\n\n    value = encodeURIComponent(String(value)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent)\n    key   = encodeURIComponent String key\n    key   = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent)\n    key   = key.replace(/[\\(\\)]/g, escape)\n\n    strAttrs = ''\n\n    for name, attr of attrs\n      continue unless attr\n      strAttrs += '; ' + name\n      continue if attr == true\n      strAttrs += '=' + attr\n\n    document.cookie = key + '=' + value + strAttrs\n\n\nexport default Cookies\n","import Cookies from './cookies'\nexport default new Cookies()\n"],"names":["Cookies"],"mappings":"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"}